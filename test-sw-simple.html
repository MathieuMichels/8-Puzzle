<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Service Worker Simple</title>
</head>
<body>
    <h1>Test Service Worker Simple</h1>
    <div id="status">Initialisation...</div>
    <button onclick="testSW()">Tester SW</button>

    <script>
        const statusDiv = document.getElementById('status');
        
        function updateStatus(message) {
            console.log(message);
            statusDiv.innerHTML += '<br>' + message;
        }
        
        function testSW() {
            updateStatus('🔧 Test du Service Worker...');
            
            if ('serviceWorker' in navigator) {
                updateStatus('✅ Service Worker supporté');
                
                navigator.serviceWorker.register('./service-worker.js', {
                    scope: './'
                })
                .then(registration => {
                    updateStatus('🎉 Service Worker enregistré!');
                    updateStatus('Scope: ' + registration.scope);
                    updateStatus('État: ' + (registration.active?.state || 'Installation...'));
                    
                    if (registration.installing) {
                        updateStatus('📦 Installation en cours...');
                    }
                    if (registration.waiting) {
                        updateStatus('⏳ En attente...');
                    }
                    if (registration.active) {
                        updateStatus('🟢 Actif!');
                    }
                })
                .catch(error => {
                    updateStatus('❌ Erreur: ' + error.message);
                    console.error('Erreur détaillée:', error);
                });
            } else {
                updateStatus('❌ Service Worker non supporté');
            }
        }
        
        // Test automatique au chargement
        window.addEventListener('load', () => {
            updateStatus('📄 Page chargée');
            testSW();
        });
    </script>
</body>
</html>
